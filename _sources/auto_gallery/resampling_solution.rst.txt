
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery/resampling_solution.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_gallery_resampling_solution.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_resampling_solution.py:


Created on Wed Jan 18 10:40:44 2017

@author: edouard.duchesnay@cea.fr

.. GENERATED FROM PYTHON SOURCE LINES 8-54




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    ACC:0.80(P=0.010); SPC:0.78(P=0.010); SEN:0.82(P=0.010)






|

.. code-block:: default


    """
    Exercise

    Given the logistic regression presented above and its validation given a 5 folds CV.

        Compute the p-value associated with the prediction accuracy using a permutation test.

        Compute the p-value associated with the prediction accuracy using a parametric test.

    """
    import numpy as np
    from sklearn import datasets
    import sklearn.linear_model as lm
    import sklearn.metrics as metrics
    from sklearn.model_selection import StratifiedKFold

    X, y = datasets.make_classification(n_samples=100, n_features=100,
                             n_informative=10, random_state=42)

    model = lm.LogisticRegression(C=1)
    nperm = 100
    scores_perm= np.zeros((nperm, 3))  # 3 scores acc, recall0, recall1

    for perm in range(0, nperm):
        # perm = 0; y == yp
        # first run on non-permuted samples
        yp = y if perm == 0 else np.random.permutation(y)
        # CV loop
        y_test_pred = np.zeros(len(yp))
        cv = StratifiedKFold(5)
        for train, test in cv.split(X, y):
            X_train, X_test, y_train, y_test = X[train, :], X[test, :], yp[train], yp[test]
            model.fit(X_train, y_train)
            y_test_pred[test] = model.predict(X_test)
        scores_perm[perm, 0] = metrics.accuracy_score(yp, y_test_pred)
        scores_perm[perm, [1, 2]] = metrics.recall_score(yp, y_test_pred, average=None)

    # Empirical permutation based p-values
    pval = np.sum(scores_perm >= scores_perm[0, :], axis=0) / nperm

    print("ACC:%.2f(P=%.3f); SPC:%.2f(P=%.3f); SEN:%.2f(P=%.3f)" %\
          (scores_perm[0, 0], pval[0],
           scores_perm[0, 1], pval[1],
           scores_perm[0, 2], pval[2]))



.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  4.068 seconds)


.. _sphx_glr_download_auto_gallery_resampling_solution.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: resampling_solution.py <resampling_solution.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: resampling_solution.ipynb <resampling_solution.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
