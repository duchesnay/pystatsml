<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Web Scraping &#8212; Statistics and Machine Learning in Python 0.8 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../_static/documentation_options.js?v=a0e24af7"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Statistics and Machine Learning in Python 0.8 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-gallery-nlp-webscraping-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="web-scraping">
<span id="sphx-glr-auto-gallery-nlp-webscraping-py"></span><h1>Web Scraping<a class="headerlink" href="#web-scraping" title="Link to this heading">¶</a></h1>
<p>Source: <a class="reference external" href="https://brightdata.com/blog/how-tos/web-scraping-with-python">Web Scraping With Python – Step-By-Step Guide</a></p>
<p>Prerequisites</p>
<p><strong>Requests</strong> library allows you to perform HTTP requests in Python, Install:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">requests</span>
</pre></div>
</div>
<p><strong>Beautiful Soup</strong> library makes scraping information
from web pages easier. In particular, Beautiful Soup works with any HTML or XML
parser and provides everything you need to iterate, search, and modify the parse tree.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">beautifulsoup4</span>
</pre></div>
</div>
<p>We will scrape <a class="reference external" href="https://quotes.toscrape.com">quotes</a>
Each quote is a bloc of &lt;div&gt; &lt;/div&gt;, that look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;div class=&quot;quote&quot;&gt;
    &lt;span class=&quot;text&quot; itemprop=&quot;text&quot;&gt;“The world as ...”&lt;/span&gt;
    &lt;span&gt;by &lt;small class=&quot;author&quot; itemprop=&quot;author&quot;&gt;Albert Einstein&lt;/small&gt;
    &lt;/span&gt;
    &lt;div class=&quot;tags&quot;&gt;
        Tags:
        &lt;a class=&quot;tag&quot; href=&quot;/tag/change/page/1/&quot;&gt;change&lt;/a&gt;
        &lt;a class=&quot;tag&quot; href=&quot;/tag/deep-thoughts/page/1/&quot;&gt;deep-thoughts&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;quote&quot;&gt;
    &lt;span class=&quot;text&quot; itemprop=&quot;text&quot;&gt;“It is our choices, ...”&lt;/span&gt;
    &lt;span&gt;by &lt;small class=&quot;author&quot; itemprop=&quot;author&quot;&gt;J.K. Rowling&lt;/small&gt;
    &lt;/span&gt;
    &lt;div class=&quot;tags&quot;&gt;
        Tags:
        &lt;a class=&quot;tag&quot; href=&quot;/tag/abilities/page/1/&quot;&gt;abilities&lt;/a&gt;
        &lt;a class=&quot;tag&quot; href=&quot;/tag/choices/page/1/&quot;&gt;choices&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
...
</pre></div>
</div>
<p>And will return CSV file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                Text              Author                        Tags
0   “The world as...     Albert Einstein       change, deep-thoughts
1   “It is our ch...        J.K. Rowling       abilities, choices
2   “There are on...     Albert Einstein       inspirational, life
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">def</span><span class="w"> </span><span class="nf">scrape_page</span><span class="p">(</span><span class="n">soup</span><span class="p">):</span>

    <span class="n">quotes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="c1"># retrieving all the quote &lt;div&gt; HTML element on the page</span>
    <span class="c1"># Right / view page source to understand the structure of the HTML page</span>
    <span class="c1"># The &lt;div&gt; tag defines a division or a section in an HTML document.</span>
    <span class="n">quote_elements</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;quote&#39;</span><span class="p">)</span>

    <span class="c1"># iterating over the list of quote elements</span>
    <span class="c1"># to extract the data of interest and store it</span>
    <span class="c1"># in quotes</span>
    <span class="k">for</span> <span class="n">quote_element</span> <span class="ow">in</span> <span class="n">quote_elements</span><span class="p">:</span>
        <span class="c1"># DEBUG: quote_element = quote_elements[0]</span>
        <span class="c1"># extracting the text of the quote</span>
        <span class="c1"># The quote text in a &lt;span&gt; HTML element: &lt;span class=&quot;text&quot;&gt; ...</span>
        <span class="c1"># The author of the quote in a &lt;small&gt; HTML element</span>
        <span class="c1"># A list of tags in a &lt;div&gt; element, each contained in &lt;a&gt; HTML element</span>

        <span class="n">text</span> <span class="o">=</span> <span class="n">quote_element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="c1"># extracting the author of the quote</span>
        <span class="n">author</span> <span class="o">=</span> <span class="n">quote_element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;author&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

        <span class="c1"># extracting the tag &lt;a&gt; HTML elements related to the quote</span>
        <span class="n">tag_elements</span> <span class="o">=</span> \
            <span class="n">quote_element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;tags&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;tag&#39;</span><span class="p">)</span>

        <span class="c1"># storing the list of tag strings in a list</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag_element</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">tag_element</span> <span class="ow">in</span> <span class="n">tag_elements</span><span class="p">]</span>

        <span class="c1"># appending a dictionary containing the quote data</span>
        <span class="c1"># in a new format in the quote list</span>
        <span class="n">quotes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">text</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span><span class="p">)])</span>

    <span class="k">return</span> <span class="n">quotes</span>
</pre></div>
</div>
<p>Url of the home page of the target website</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://quotes.toscrape.com&#39;</span>

<span class="c1"># defining the User-Agent header to use in the GET request below</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Retrieving the target web page.
<cite>page.text</cite> will contain the HTML document returned by the server in string format</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</pre></div>
</div>
<p>Parsing the target web page with Beautiful Soup</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>scraping the home page</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">quotes</span> <span class="o">=</span> <span class="n">scrape_page</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
</pre></div>
</div>
<p>getting the “Next” HTML element</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">next_li_element</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;next&#39;</span><span class="p">)</span>

<span class="c1"># if there is a next page to scrape</span>
<span class="k">while</span> <span class="n">next_li_element</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">next_page_relative_url</span> <span class="o">=</span> <span class="n">next_li_element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>

    <span class="c1"># getting the new page</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span> <span class="o">+</span> <span class="n">next_page_relative_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="c1"># parsing the new page</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>

    <span class="c1"># scraping the new page and append to the quotes</span>
    <span class="n">quotes</span> <span class="o">+=</span> <span class="n">scrape_page</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>

    <span class="c1"># looking for the &quot;Next →&quot; HTML element in the new page</span>
    <span class="n">next_li_element</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;next&#39;</span><span class="p">)</span>


<span class="c1"># Write csv file</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">quotes</span><span class="p">,</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Text&#39;</span><span class="p">,</span> <span class="s1">&#39;Author&#39;</span><span class="p">,</span> <span class="s1">&#39;Tags&#39;</span><span class="p">])</span>

<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;quotes.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 3.174 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-gallery-nlp-webscraping-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/d886dd5ad0f7f38e02512a886a2838a7/nlp_webscraping.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">nlp_webscraping.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a7fb5e96bb8d54fab3c795fb1671d269/nlp_webscraping.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">nlp_webscraping.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/cd05dd81622596852c156699b22cea26/nlp_webscraping.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">nlp_webscraping.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/auto_gallery/nlp_webscraping.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2020, Edouard Duchesnay, NeuroSpin CEA Université Paris-Saclay, France.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/auto_gallery/nlp_webscraping.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>